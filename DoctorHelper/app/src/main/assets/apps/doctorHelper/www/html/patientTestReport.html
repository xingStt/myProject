<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    	<meta http-equiv="Access-Control-Allow-Origin" content="">
		<meta http-equiv="content-security-policy">
    <title>病人检测报告</title>
    <link rel="stylesheet" type="text/css" href="../css/mui.min.css"/>
    <link rel="stylesheet" href="../css/patientTeset.css" />
</head>
<body>
	<header id='header' class="mui-bar mui-bar-nav" style="padding:0 1rem 0 1rem;">
    	<div id="title_div">
    			<div class="title-1"><span>序号</span></div>
				<div class="title-2"><span>检查项目</span></div>
				<div class="title-3"><span>检查结果</span></div>
				<div class="title-4"><span>结果单位</span></div>
				<div class="title-5"><span>参考值</span></div>
    	</div>
    </header>
    <div id="content_div" class="mui-content" style="background:#F6F6F6;overflow-y:auto ;">
    
    </div>
</body>
</html>
<script src="../script/zepto.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../script/mui.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="../script/Url.js" ></script>
<script src="../script/react.production.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../script/react-dom.production.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../script/babel.min.js" type="text/javascript" charset="utf-8"></script>
 <script type="text/babel">
				$.ajax({
			        type: 'post',
			       	url: Url_+'/deskNurse/doctor/getPatientTestReport.do',
			        data: {'nisid':localStorage.getItem("nisid")},
			        dataType: "json",
			        success: function(data){
			        	$("#items").html(data[0].items);
			        	$("#specimen").html(data[0].specimen);
			        	$("#emp_name").html(data[0].emp_name);
			        	$("#kddate").html(data[0].kddate);
			        	load(data);
			        },error: function() {
                    },
			    });
			    
			    
			    function TableContent(props){
			    	let className="";
			    	let result = props.result; 
			    	
			    	let normal = props.normal;
			    	if(normal){
			    		let arr = normal.split('-');
			    		let ret = parseFloat(result);
			    		
			    		if(arr.length>1){
			    			let min = parseFloat(arr[0]);
					    	let max = parseFloat(arr[1]);
					    	
					    	if(min>ret||max<ret){
					    		className = 'unnormal';
					    	}
			    		}else{
			    			let firstchar = normal.substring(0,1);
			    			let value = parseFloat(normal.substring(1,normal.length));
			    			if(firstchar==='<'&&ret>value){
			    				className = 'unnormal';
			    			}
			    			
			    			if(firstchar==='>'&&ret<value){
			    				className = 'unnormal';
			    			}
			    		}
			    	}
			    	
			    	if(result==='阳性'){
			    		className = 'unnormal';
			    	}
			    	
			    	return(
			    		<div class={className}>
			    			<div class="content-1"><span>{props.id}</span>
			    			</div>
			    			<div class="content-2"><span>{props.item}</span>
			    			</div>
			    			<div class="content-3"><span>{result}</span>
			    			</div>
			    			<div class="content-4"><span>{props.unit}</span>
			    			</div>
			    			<div class="content-5"><span>{props.normal}</span>
			    			</div>
			    		</div>
			    	)
			    }
			    
			    function Repeat(props){
					let list = props.data;
					let items = [];
					for(let i=0;i<list.length;i++){
						items.push(<TableContent id={i+1} item={list[i].item} result={list[i].result} 
							unit={list[i].unit} normal={list[i].normal} />);
					}
					return <div>{items}</div>
				}
			    
			    function TableBind(props){
			    	return(
			    		<Repeat data={props.data}/>
			    	)
			    }
			    
			    function load(data){
					ReactDOM.render(
						<TableBind  data={data}/>,
						document.getElementById('content_div')
					);
				}
</script>